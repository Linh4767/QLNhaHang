@model IEnumerable<QLNhaHang.Models.ViTriCongViec>
@using X.PagedList.Mvc.Core;
@using X.PagedList;
@{
    Layout = "Header";
    ViewData["Title"] = "ViTriCongViecList";
}
@if (TempData["ThongBaoThem"] != null)
{
    <div id="them" class="alert @((TempData["ThongBaoThem"].ToString().Contains("thành công")) ? "alert-success" : "alert-danger")">
        @TempData["ThongBaoThem"]
    </div>
}

@if (TempData["ThongBaoXoa"] != null)
{
    <div id="xoa" class="alert @((TempData["ThongBaoXoa"].ToString().Contains("thành công")) ? "alert-success" : "alert-danger")">
        @TempData["ThongBaoXoa"]
    </div>
}

@if (TempData["ThongBaoSua"] != null)
{
    <div id="sua" class="alert @((TempData["ThongBaoSua"].ToString().Contains("thành công")) ? "alert-success" : "alert-danger")">
        @TempData["ThongBaoSua"]
    </div>
}

<script>
    // Ẩn thông báo sau 3 giây
    setTimeout(function () {
        var them = document.getElementById("them");
        var xoa = document.getElementById("xoa");
        var sua = document.getElementById("sua");

        if (them) {
            them.style.display = "none";
        }
        if (xoa) {
            xoa.style.display = "none";
        }
        if (sua) {
            sua.style.display = "none";
        }
    }, 3000);
</script>
<h2>Quản Lý Vị Trí Công Việc</h2>
<div class="d-flex justify-content-between align-items-center mb-3 mt-3">
    <input type="text" class="form-control w-50" placeholder="Tìm kiếm vị trí công việc..." id="searchInput" />
    <a class="btn btn-success" id="btnAdd" asp-controller="Admin" asp-action="ThemViTriCV">Thêm mới</a>
</div>
<div class="table-responsive mb-3" id="viTriCongViecContainer">
    @await Html.PartialAsync("_ViTriCongViecContainer", Model)
</div>
@* @Html.PagedListPager(
        (IPagedList)Model,
        page => Url.Action("TimKiemViTriCongViec", new { page = page, searchQuery = ViewBag.SearchQuery }),
        new X.PagedList.Mvc.Core.PagedListRenderOptions
    {
        ContainerDivClasses = new[] { "navigation" },
        LiElementClasses = new[] { "page-item" },
        PageClasses = new[] { "page-link" },
        ActiveLiElementClass = "active" // Đánh dấu trang hiện tại
    }
    ) *@

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        // Gửi yêu cầu AJAX khi ngày hoặc mã ca thay đổi
        $("#Ngay, #MaCa").on("change", function () {
            const ngay = $("#Ngay").val(); // Lấy giá trị ngày
            const maCa = $("#MaCa").val(); // Lấy giá trị mã ca

            // Gửi yêu cầu AJAX đến action LayMaQuanLyMoi
            $.ajax({
                url: '/Admin/LayMaQuanLyMoi', // Route đến action API mới
                method: 'GET',
                data: { ngay: ngay, maCa: maCa }, // Truyền ngày và mã ca lên server
                success: function (data) {
                    // Cập nhật mã quản lý trên form
                    $("#MaQuanLy").val(data.maQuanLy);
                },
                error: function () {
                    alert("Không thể cập nhật mã quản lý.");
                }
            });
        });
    });
</script>


